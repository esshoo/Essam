<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ - Ø¹ØµØ§Ù…</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 90%; max-width: 400px; text-align: center; }
        h2 { color: #333; margin-bottom: 10px; }
        p { color: #666; margin-bottom: 30px; }
        
        .btn { width: 100%; padding: 15px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; font-family: inherit; font-size: 16px; margin-bottom: 15px; display: flex; align-items: center; justify-content: center; gap: 10px; transition: transform 0.2s; }
        .btn:active { transform: scale(0.98); }
        
        .btn-google { background: #db4437; color: white; }
        .btn-guest { background: #607d8b; color: white; }
        
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 20px auto; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="card">
        <h2>ğŸ‘‹ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ</h2>
        <p>Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± - Ù…. Ø¹ØµØ§Ù…</p>

        <button class="btn btn-google" onclick="loginGoogle()">
            <span>G</span> ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¬ÙˆØ¬Ù„
        </button>

        <button class="btn btn-guest" onclick="loginGuest()">
            ğŸ‘¤ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒØ¶ÙŠÙ (Ø¨Ø¯ÙˆÙ† Ø­Ø³Ø§Ø¨)
        </button>

        <div id="loading" class="loader"></div>
        <p id="status-msg" style="font-size: 0.9em; margin-top: 10px;"></p>
    </div>

    <script type="module">
        // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…ÙƒØªØ¨Ø§Øª Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signInAnonymously, onAuthStateChanged } 
        from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // =================================================
        // âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªÙƒ (ÙŠØ¬Ø¨ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙÙ‚Ø·)
        // =================================================
        const ADMIN_EMAIL = "esshoo@gmail.com"; // âš ï¸ Ø§ÙƒØªØ¨ Ø¥ÙŠÙ…ÙŠÙ„Ùƒ Ù‡Ù†Ø§ Ø¨Ø¯Ù‚Ø©!
        // =================================================

        const firebaseConfig = {
            apiKey: "AIzaSyCV6xsRfSlpt5t9YNCVIivxJoRwj1TIexs",
            authDomain: "essam-support.firebaseapp.com",
            projectId: "essam-support",
            storageBucket: "essam-support.firebasestorage.app",
            messagingSenderId: "1062222968750",
            appId: "1:1062222968750:web:1c827c20729f76fbe7ba3f"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ø§Ù„Ù…ÙˆØ¬Ù‡ Ø§Ù„Ø°ÙƒÙŠ)
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('loading').style.display = 'block';
                document.getElementById('status-msg').innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡...";

                if (user.isAnonymous) {
                    // 1. Ø¶ÙŠÙ -> ÙŠØ°Ù‡Ø¨ Ù„ØµÙØ­Ø© Ø§Ù„Ø¶ÙŠÙˆÙ
                    console.log("User is Guest");
                    window.location.href = "guest.html";
                } else {
                    // 2. Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ -> Ù†ÙØ­Øµ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
                    console.log("User Email:", user.email);
                    if (user.email === ADMIN_EMAIL) {
                        // Ù‡Ø°Ø§ Ø¹ØµØ§Ù…! -> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                        window.location.href = "admin.html";
                    } else {
                        // Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ -> ØµÙØ­Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
                        window.location.href = "client.html";
                    }
                }
            }
        });

        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± (ÙŠØ¬Ø¨ Ø±Ø¨Ø·Ù‡Ø§ Ø¨Ø§Ù„Ù€ window)
        window.loginGoogle = function() {
            const provider = new GoogleAuthProvider();
            signInWithPopup(auth, provider).catch((error) => {
                alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„: " + error.message);
            });
        }

        window.loginGuest = function() {
            signInAnonymously(auth).catch((error) => {
                alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒØ¶ÙŠÙ: " + error.message);
            });
        }
    </script>
</body>
</html>

