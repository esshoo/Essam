<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link rel="icon" type="image/svg+xml" href="" id="dynamic-favicon">
    <title>ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø¹ØµØ§Ù… Ø§Ù„Ø®Ø§Øµ</title>
    <script src="https://unpkg.com/peerjs@1.5.1/dist/peerjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #0088cc; --bg: #e5ddd5; --white: #ffffff; --green: #25d366; --red: #ff3b30; --msg-me: #dcf8c6; }
        body { font-family: 'Tajawal', sans-serif; margin: 0; background: #f0f2f5; height: 100vh; overflow: hidden; display: flex; justify-content: center; }

        .screen { width: 100%; max-width: 500px; height: 100%; background: var(--bg); display: none; flex-direction: column; position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        .active-screen { display: flex; }

        /* Ø§Ù„Ø´Ø¹Ø§Ø± */
        .Essam { text-align: center; margin-bottom: 20px; }
        .Essam img { max-height: 80px; max-width: 100%; }
        .Essam h1 { margin: 10px 0 0; color: var(--main-color); font-size: 1.5rem; }

		.Essam:hover {
		background: linear-gradient(135deg, rgba(0, 210, 255, 0.5), rgba(0, 210, 255, 0.2));
		border-color: rgba(255, 255, 255, 0.6);
		transform: translateY(-2px);
		border-radius: 24px;
		box-shadow: 0 6px 15px rgba(0, 210, 255, 0.3); /* Ø¸Ù„ Ù…Ù„ÙˆÙ† */
		}
		
				/* Ù‡Ø°Ø§ Ø³ÙŠØ¬Ø¹Ù„ Ø§Ù„Ø®Ø·ÙˆØ· Ø£Ø³Ù…Ùƒ ÙˆØ£ÙˆØ¶Ø­ */
		.Essam svg path, 
		.Essam svg circle, 
		.Essam svg line {
		stroke-width: 20px; /* Ø¬Ø±Ø¨ Ø²ÙŠØ§Ø¯Ø© Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… */
		/* vector-effect ÙŠØ¶Ù…Ù† Ø¹Ø¯Ù… Ù†Ø­Ø§ÙØ© Ø§Ù„Ø®Ø· Ø¹Ù†Ø¯ Ø§Ù„ØªØµØºÙŠØ±ØŒ ÙˆÙ„ÙƒÙ† Ø§Ù„Ù€ SVG Ù‡Ù†Ø§ Ù…Ø¶Ù…Ù† */
		}

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #login-screen { background: var(--white); justify-content: center; align-items: center; padding: 20px; text-align: center; }
        input { width: 80%; padding: 15px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; font-family: inherit; font-size: 16px; transition: 0.3s; }
        
        /* Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ Ø§Ù„Ù…Ø®ÙÙŠ */
        #password-field { 
            display: none; 
            border: 2px solid var(--red); 
            background-color: #fff0f0;
        }
        
        .btn { padding: 12px 25px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; color: white; margin: 5px; font-family: inherit; width: 85%; }
        .btn-primary { background: var(--primary); }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { background: var(--primary); color: white; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; z-index: 10; box-shadow: 0 2px 5px rgba(0,0,0,0.1); height: 60px; box-sizing: border-box; }
        
        .user-info { display: flex; flex-direction: column; align-items: flex-start; }
        .user-name { font-weight: bold; font-size: 1.1em; }
        .user-status { font-size: 0.75em; opacity: 0.9; }

        /* Ø²Ø± Ø§Ù„Ø®Ø±ÙˆØ¬ (Ø£Ù‚ØµÙ‰ Ø§Ù„ÙŠØ³Ø§Ø±) */
        .logout-btn { 
            background: rgba(255, 255, 255, 0.2); 
            border: 1px solid rgba(255,255,255,0.4); 
            color: white; 
            padding: 5px 12px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 0.8em; 
            display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
            margin-left: 10px;
        }
        .logout-btn:hover { background: rgba(255, 59, 48, 0.8); border-color: var(--red); }

        .call-actions { display: flex; align-items: center; }
        .call-actions button { background: none; border: none; color: white; font-size: 1.4em; cursor: pointer; margin-right: 10px; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .btn-active-call { background-color: var(--red) !important; animation: pulse-red 1s infinite; }
        @keyframes pulse-red { 0% { box-shadow: 0 0 0 0 rgba(255, 59, 48, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(255, 59, 48, 0); } }

        /* Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª */
        .chat-body { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .message { max-width: 75%; padding: 10px 15px; border-radius: 15px; font-size: 15px; position: relative; word-wrap: break-word; }
        .msg-me { background: var(--msg-me); align-self: flex-end; border-bottom-left-radius: 0; }
        .msg-other { background: var(--white); align-self: flex-start; border-bottom-right-radius: 0; }
        .sys-msg { align-self: center; background: rgba(0,0,0,0.1); padding: 5px 15px; border-radius: 20px; font-size: 0.8em; color: #555; margin: 5px 0; text-align: center; }
        
        .media-thumb { max-width: 200px; max-height: 150px; border-radius: 10px; margin-top: 5px; cursor: pointer; border: 2px solid rgba(0,0,0,0.1); }
        .file-link { display: flex; align-items: center; text-decoration: none; color: #333; background: rgba(0,0,0,0.05); padding: 10px; border-radius: 10px; margin-top: 5px; }
        .chat-footer { background: #f0f0f0; padding: 10px; display: flex; align-items: center; gap: 10px; }
        .chat-footer input { margin: 0; flex: 1; border: none; padding: 12px; border-radius: 20px; }
        .attach-btn { font-size: 1.5em; cursor: pointer; color: #555; padding: 0 10px; }

        #incoming-modal, #video-modal, #lightbox-modal { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; display: none; }
        #incoming-modal { background: rgba(0,0,0,0.9); flex-direction: column; justify-content: center; align-items: center; color: white; }
        #video-modal { background: black; }
        #lightbox-modal { background: rgba(0,0,0,0.95); display: none; justify-content: center; align-items: center; z-index: 200; }
        
        #remote-video { width: 100%; height: 100%; object-fit: cover; }
        #local-video { position: absolute; bottom: 20px; right: 20px; width: 100px; height: 140px; background: #333; border: 2px solid white; border-radius: 10px; object-fit: cover; transform: scaleX(-1); }
        #lightbox-img { max-width: 100%; max-height: 100%; object-fit: contain; }
        #lightbox-video { max-width: 100%; max-height: 100%; }
        .close-lightbox { position: absolute; top: 20px; right: 20px; color: white; font-size: 30px; cursor: pointer; z-index: 201; background: rgba(0,0,0,0.5); width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .incoming-actions { margin-top: 50px; display: flex; gap: 40px; }
        .action-btn { width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; cursor: pointer; color: white; border: none; }
    </style>
</head>
<body>

    <div id="login-screen" class="screen active-screen">
	<div class="Essam">
    <a href="https://api.whatsapp.com/message/SQQ6KNXP4HFSF1" target="_blank" title="ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§">
        <svg width="150" height="150" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1051 1051" preserveAspectRatio="xMidYMid meet">
            <defs>
                <clipPath id="circleView">
                    <circle cx="525.5" cy="525.5" r="500" />
                </clipPath>
            </defs>
            <g clip-path="url(#circleView)">
                    <path d="M 491.50 791.94 C485.45,791.52 478.25,790.65 475.50,790.01 C472.75,789.37 466.94,788.22 462.58,787.44 C453.91,785.90 447.01,783.96 425.50,777.04 C421.96,775.90 416.66,773.76 410.50,770.99 C409.40,770.49 406.74,769.39 404.59,768.53 C402.94,767.87 402.04,767.42 401.16,767.47 C399.78,767.55 398.47,768.88 394.38,772.57 C390.37,776.20 378.48,781.85 370.42,783.96 C352.98,788.53 336.58,785.43 319.09,774.27 C316.11,772.37 313.04,770.18 312.27,769.41 C310.75,767.89 311.09,767.25 318.74,757.15 C321.55,753.44 323.07,751.64 322.90,750.02 C322.70,748.20 320.34,746.61 315.21,742.79 C310.42,739.23 304.61,735.07 302.30,733.56 C294.43,728.39 293.06,723.61 298.11,718.90 C302.68,714.63 307.78,715.22 314.00,720.73 C314.83,721.46 318.82,724.41 322.88,727.28 C326.94,730.15 331.12,733.13 332.17,733.90 C333.85,735.13 334.31,735.05 336.04,733.19 C337.12,732.03 338.00,730.82 338.00,730.51 C338.00,730.01 345.53,719.73 349.49,714.83 C350.24,713.91 351.40,712.12 352.08,710.85 C352.76,709.58 353.88,707.98 354.56,707.30 C356.28,705.57 360.31,698.96 359.86,698.59 C359.66,698.42 357.02,696.57 354.00,694.48 C350.98,692.39 348.27,690.38 348.00,690.02 C347.73,689.65 344.78,687.52 341.46,685.28 C333.90,680.18 332.95,679.03 332.29,674.10 C331.79,670.42 332.00,669.97 335.13,668.06 C341.08,664.44 342.99,665.07 357.34,675.46 C359.99,677.39 363.96,680.38 366.14,682.11 C370.07,685.22 370.13,685.23 371.93,683.30 C372.93,682.23 374.37,680.24 375.13,678.88 C377.31,674.95 383.42,667.08 384.32,667.04 C384.77,667.02 388.03,669.06 391.57,671.59 C398.68,676.66 405.86,684.35 408.66,689.89 C409.66,691.87 411.00,694.17 411.62,695.00 C412.25,695.83 413.94,700.55 415.38,705.50 C418.47,716.11 418.86,727.88 416.44,737.22 C415.59,740.52 415.07,743.41 415.30,743.63 C416.26,744.60 441.00,754.34 447.93,756.49 C492.38,770.24 538.01,772.12 578.50,761.85 C582.90,760.74 587.74,759.61 589.26,759.35 C592.29,758.83 606.59,753.81 617.39,749.46 C638.20,741.11 669.37,721.84 684.50,707.99 C697.85,695.78 701.03,692.58 708.36,684.00 C712.82,678.78 716.72,674.28 717.02,674.00 C717.32,673.72 719.34,671.03 721.52,668.00 C723.69,664.97 725.81,662.35 726.23,662.17 C726.65,661.98 727.00,661.46 727.00,661.00 C727.00,660.23 732.88,650.74 734.74,648.50 C735.20,647.95 736.48,645.70 737.60,643.50 C738.72,641.30 740.73,637.70 742.06,635.50 C743.40,633.30 744.51,631.28 744.52,631.00 C744.53,630.72 745.58,628.25 746.86,625.50 C753.16,611.95 757.01,602.40 757.97,598.00 C758.38,596.08 759.46,592.70 760.36,590.50 C761.26,588.30 762.18,585.15 762.39,583.50 C762.61,581.85 763.95,575.82 765.37,570.11 C766.78,564.39 767.75,559.41 767.52,559.03 C767.29,558.66 767.83,554.11 768.72,548.93 C770.73,537.27 771.04,503.81 769.25,493.38 C768.57,489.46 767.77,483.39 767.47,479.88 C767.16,476.37 766.01,470.17 764.92,466.11 C763.82,462.04 762.78,457.47 762.61,455.95 C762.24,452.83 758.82,442.01 755.81,434.50 C754.71,431.75 753.47,428.15 753.05,426.50 C752.63,424.85 751.27,421.81 750.04,419.75 C748.81,417.69 748.04,416.00 748.33,416.00 C748.77,416.00 743.27,404.83 741.20,401.53 C740.85,400.96 740.47,399.94 740.37,399.25 C740.26,398.57 738.79,396.12 737.09,393.81 C735.39,391.50 734.00,389.30 734.00,388.94 C734.00,388.14 727.18,377.93 720.96,369.39 C703.71,345.77 671.03,315.72 655.81,309.49 C652.34,308.07 648.60,306.53 647.50,306.06 C642.87,304.10 633.64,301.65 620.59,298.92 C607.68,296.21 605.10,296.00 584.97,296.00 C565.93,296.00 561.76,296.30 550.89,298.46 C526.45,303.33 513.56,308.01 491.00,320.22 C487.98,321.86 484.07,324.28 482.32,325.60 C480.57,326.92 478.83,328.00 478.46,328.00 C477.04,328.00 458.13,343.77 450.95,350.95 C443.92,357.98 428.00,377.03 428.00,378.41 C428.00,378.75 426.26,381.61 424.13,384.76 C422.01,387.92 419.64,391.68 418.88,393.12 C414.42,401.57 411.29,407.16 405.94,416.28 C402.65,421.90 399.52,427.17 398.99,428.00 C398.46,428.83 397.19,431.08 396.17,433.00 C395.14,434.92 392.59,439.42 390.50,443.00 C388.42,446.58 383.92,454.45 380.51,460.50 C377.10,466.55 372.60,474.42 370.51,478.00 C368.41,481.58 365.69,486.30 364.47,488.50 C363.24,490.70 361.02,494.64 359.53,497.25 L 356.83 502.00 L 482.41 502.00 L 468.46 516.25 C450.91,534.18 409.70,576.08 335.40,651.51 C303.45,683.96 269.63,718.38 260.25,728.00 C250.87,737.62 242.90,745.21 242.54,744.86 C242.18,744.50 244.16,740.83 246.94,736.68 C249.72,732.54 252.00,728.71 252.00,728.16 C252.00,727.61 252.38,727.02 252.84,726.83 C253.30,726.65 257.10,721.10 261.28,714.50 C265.46,707.90 269.25,702.05 269.69,701.50 C271.84,698.83 276.00,691.93 276.00,691.02 C276.00,690.46 276.37,690.00 276.82,690.00 C277.28,690.00 278.63,688.02 279.84,685.61 C281.04,683.20 282.70,680.66 283.52,679.99 C284.33,679.31 285.00,678.14 285.00,677.38 C285.00,676.62 285.48,676.00 286.06,676.00 C286.64,676.00 286.87,675.60 286.57,675.11 C286.27,674.63 286.70,673.66 287.53,672.97 C288.36,672.28 290.27,669.53 291.77,666.86 C293.27,664.19 294.84,662.00 295.25,662.00 C295.66,662.00 296.00,661.39 296.00,660.65 C296.00,659.92 296.90,658.50 298.00,657.50 C299.10,656.50 300.00,655.29 300.00,654.80 C300.00,654.31 301.69,651.37 303.75,648.27 C305.81,645.16 308.40,641.20 309.50,639.46 C313.76,632.70 315.92,629.45 316.94,628.29 C317.52,627.63 318.00,626.80 318.00,626.45 C318.00,625.86 325.50,613.98 329.97,607.50 C331.11,605.85 333.76,601.80 335.86,598.50 C337.97,595.20 342.71,587.86 346.40,582.18 C350.10,576.50 353.36,571.22 353.67,570.43 C354.14,569.20 344.27,569.00 282.63,569.00 L 211.04 569.00 L 212.15 566.25 C213.37,563.22 218.69,551.51 220.11,548.75 C220.60,547.79 221.40,546.21 221.89,545.25 C222.38,544.29 224.77,539.22 227.20,534.00 C229.64,528.78 233.58,520.45 235.97,515.50 C238.36,510.55 240.27,506.27 240.22,506.00 C240.18,505.73 241.42,503.02 242.99,500.00 C244.55,496.98 247.86,490.23 250.33,485.00 C254.70,475.78 256.06,472.87 266.90,449.50 C269.71,443.45 272.90,436.84 274.00,434.80 C275.10,432.77 276.00,430.59 276.00,429.97 C276.00,428.53 282.89,412.39 287.26,403.60 C290.76,396.55 296.49,386.24 297.63,384.92 C298.38,384.05 299.00,382.97 299.00,382.52 C299.00,382.06 300.24,380.08 301.75,378.10 C303.26,376.13 305.02,373.52 305.67,372.31 C306.31,371.09 307.32,369.51 307.92,368.80 C308.53,368.08 310.92,365.02 313.25,362.00 C315.57,358.98 317.93,355.95 318.49,355.28 C319.04,354.61 320.62,352.63 322.00,350.87 C331.19,339.15 369.13,305.00 372.97,305.00 C373.53,305.00 374.00,304.65 374.00,304.23 C374.00,303.81 376.02,302.35 378.50,301.00 C380.98,299.65 383.00,298.23 383.00,297.84 C383.00,297.45 384.01,296.82 385.25,296.44 C386.49,296.06 389.30,294.56 391.50,293.11 C396.83,289.59 420.37,278.00 422.17,278.00 C422.96,278.00 424.03,277.64 424.55,277.20 C426.83,275.28 443.55,269.64 457.50,266.08 C486.65,258.66 514.88,256.70 552.58,259.50 C571.18,260.88 596.49,267.39 624.07,277.89 C637.53,283.01 658.83,294.95 677.11,307.62 C696.10,320.77 724.92,349.62 737.74,368.31 C746.22,380.65 749.00,385.01 749.00,385.93 C749.00,386.43 749.41,386.98 749.91,387.17 C750.92,387.54 765.42,415.52 767.44,421.00 C773.57,437.64 780.13,457.98 780.56,461.70 C780.70,462.91 781.72,468.08 782.84,473.20 C788.97,501.42 788.96,547.21 782.80,575.50 C781.72,580.45 780.66,585.85 780.44,587.50 C780.21,589.15 779.58,591.62 779.04,593.00 C778.49,594.38 777.39,597.97 776.60,601.00 C775.25,606.18 771.97,615.45 767.02,628.00 C763.23,637.63 749.51,663.74 745.74,668.50 C745.30,669.05 743.51,671.75 741.75,674.50 C729.57,693.52 704.84,720.24 686.64,734.03 C673.88,743.70 662.78,751.49 657.61,754.42 C655.35,755.70 650.64,758.38 647.15,760.38 C643.66,762.37 640.60,764.00 640.35,764.00 C640.10,764.00 636.21,765.84 631.70,768.09 C627.19,770.34 621.92,772.76 620.00,773.48 C597.59,781.76 585.55,785.47 576.00,787.02 C573.53,787.42 568.12,788.50 564.00,789.43 C549.76,792.62 517.33,793.74 491.50,791.94 Z" fill="rgba(2,4,8,1)"/>
                    <path d="M 262.59 889.96 C258.10,888.62 252.26,882.26 250.27,876.57 C247.56,868.82 247.87,852.12 250.84,845.54 C253.58,839.46 255.44,837.33 260.10,834.95 C269.39,830.21 280.52,831.62 287.53,838.43 C293.03,843.77 295.53,853.11 294.74,865.36 C293.84,879.46 289.68,886.86 281.08,889.67 C276.88,891.05 266.76,891.20 262.59,889.96 ZM 276.25 876.87 C280.47,871.21 279.44,847.82 274.83,844.59 C272.13,842.70 267.67,844.24 266.14,847.60 C264.41,851.40 264.66,872.44 266.48,875.96 C268.96,880.76 273.08,881.14 276.25,876.87 ZM 313.77 889.86 C309.31,888.61 302.71,882.49 301.23,878.23 L 300.16 875.17 L 305.33 874.53 C308.17,874.18 311.75,873.65 313.27,873.36 C315.68,872.90 316.19,873.25 317.13,875.94 C319.01,881.34 325.01,882.75 328.83,878.69 C331.98,875.33 331.90,867.19 328.69,864.17 C325.75,861.42 322.03,861.40 318.56,864.13 C316.13,866.04 315.23,866.17 309.68,865.38 L 303.50 864.50 L 303.26 860.50 C303.13,858.30 304.03,851.33 305.27,845.00 L 307.53 833.50 L 326.31 833.23 L 345.09 832.96 L 344.80 839.60 L 344.50 846.25 L 333.00 846.11 C326.67,846.04 321.05,846.32 320.50,846.74 C319.95,847.16 319.35,849.02 319.17,850.89 C318.88,853.86 319.06,854.18 320.67,853.47 C323.88,852.05 330.51,851.79 334.70,852.92 C337.41,853.65 340.16,855.53 342.98,858.59 L 347.20 863.18 L 346.85 871.00 C346.53,877.99 346.16,879.23 343.39,882.66 C338.50,888.71 334.87,890.34 325.59,890.64 C321.14,890.79 315.82,890.44 313.77,889.86 ZM 367.50 889.86 C362.69,888.09 357.21,882.14 355.28,876.57 C352.57,868.77 352.87,852.09 355.83,845.54 C357.07,842.81 358.85,839.72 359.79,838.68 C364.33,833.66 375.94,830.83 383.55,832.88 C389.43,834.46 395.47,840.04 397.49,845.75 C400.06,853.03 400.58,866.21 398.59,873.97 C396.35,882.68 394.19,886.13 389.52,888.43 C384.90,890.70 372.06,891.53 367.50,889.86 ZM 381.33 876.77 C385.58,871.05 384.50,847.87 379.83,844.59 C376.83,842.49 372.43,844.32 371.07,848.22 C369.70,852.17 369.68,871.00 371.05,874.68 C373.22,880.53 377.83,881.47 381.33,876.77 ZM 474.00 889.83 C469.30,888.51 464.27,883.59 461.39,877.50 C459.36,873.23 459.02,870.96 459.01,861.91 C459.00,851.92 459.19,850.94 462.25,844.91 C464.96,839.56 466.33,838.05 470.50,835.79 C479.68,830.81 490.57,831.14 497.75,836.63 C501.10,839.18 504.90,845.44 503.78,846.56 C503.46,846.88 499.87,847.39 495.82,847.70 C488.55,848.25 488.42,848.21 487.21,845.57 C486.20,843.35 485.43,842.93 482.84,843.19 C478.97,843.57 476.29,846.98 475.42,852.65 L 474.78 856.81 L 479.87 854.29 C490.63,848.96 501.60,854.65 505.08,867.37 C507.50,876.22 501.21,887.48 492.50,889.88 C487.69,891.21 478.81,891.19 474.00,889.83 ZM 487.93 878.37 C489.29,876.64 490.00,874.27 490.00,871.48 C490.00,865.89 487.44,862.67 483.00,862.67 C478.50,862.67 476.00,865.88 476.00,871.66 C476.00,879.77 483.50,883.99 487.93,878.37 ZM 576.04 889.83 C568.14,887.56 564.00,881.88 564.00,873.35 C564.01,868.00 566.52,862.86 570.05,860.97 L 572.20 859.82 L 569.58 857.09 C565.94,853.29 564.75,848.58 566.19,843.75 C569.34,833.25 586.91,828.83 599.87,835.28 C605.48,838.07 607.99,842.07 608.00,848.22 C608.00,852.02 607.43,853.58 605.03,856.32 L 602.05 859.70 L 604.62 862.10 C608.30,865.54 610.00,869.30 610.00,874.02 C610.00,884.72 600.95,891.11 586.07,890.91 C582.46,890.86 577.94,890.37 576.04,889.83 ZM 591.55 878.55 C594.58,875.51 594.73,871.20 591.93,867.63 C589.37,864.38 585.49,864.19 582.31,867.17 C579.38,869.93 579.28,874.81 582.07,878.37 C584.70,881.70 588.32,881.77 591.55,878.55 ZM 591.00 853.00 C593.40,850.60 593.54,848.21 591.44,845.22 C589.59,842.58 584.90,842.24 582.57,844.57 C580.24,846.90 580.58,851.59 583.22,853.44 C586.21,855.54 588.60,855.40 591.00,853.00 ZM 426.00 871.68 L 426.00 853.36 L 418.40 857.18 C414.22,859.28 410.40,860.74 409.90,860.44 C409.41,860.13 409.00,857.03 409.00,853.55 C409.00,847.47 409.11,847.19 411.75,846.54 C416.83,845.29 422.91,840.99 426.05,836.43 L 429.16 831.91 L 435.33 832.20 L 441.50 832.50 L 441.77 861.25 L 442.03 890.00 L 434.02 890.00 L 426.00 890.00 L 426.00 871.68 ZM 531.00 871.68 L 531.00 853.36 L 523.40 857.18 C519.22,859.28 515.40,860.74 514.90,860.44 C514.41,860.13 514.00,857.23 514.00,853.99 L 514.00 848.10 L 520.53 844.99 C525.42,842.65 527.99,840.62 530.77,836.89 L 534.49 831.92 L 540.49 832.21 L 546.50 832.50 L 546.77 861.25 L 547.03 890.00 L 539.02 890.00 L 531.00 890.00 L 531.00 871.68 ZM 636.00 871.49 L 636.00 852.97 L 632.25 855.31 C627.43,858.30 620.40,861.07 619.61,860.28 C619.28,859.94 619.00,857.08 619.00,853.92 L 619.00 848.18 L 625.74 844.84 C630.66,842.40 633.42,840.22 635.99,836.75 L 639.50 832.00 L 645.75 832.00 L 652.00 832.00 L 652.00 861.00 L 652.00 890.00 L 644.00 890.00 L 636.00 890.00 L 636.00 871.49 ZM 688.00 871.43 L 688.00 852.86 L 685.11 854.92 C682.62,856.69 673.63,861.00 672.42,861.00 C672.19,861.00 672.00,857.90 672.00,854.11 C672.00,847.42 672.08,847.20 674.75,846.54 C679.38,845.39 686.64,840.15 689.43,835.92 L 692.09 831.91 L 698.29 832.20 L 704.50 832.50 L 704.77 861.25 L 705.03 890.00 L 696.52 890.00 L 688.00 890.00 L 688.00 871.43 ZM 720.00 888.75 C720.00,885.96 726.01,875.05 729.43,871.64 C731.44,869.63 736.40,865.49 740.47,862.43 C751.44,854.17 753.70,849.27 748.45,845.14 C746.32,843.46 745.41,843.31 742.87,844.19 C740.11,845.16 739.07,846.54 737.68,851.07 C737.27,852.42 736.10,852.52 729.42,851.81 C725.14,851.35 721.50,850.83 721.32,850.66 C720.35,849.68 724.63,840.09 727.06,837.80 C730.26,834.78 738.43,832.00 744.13,832.00 C758.47,832.00 767.00,838.64 767.00,849.80 C767.00,856.30 763.56,861.01 752.39,869.79 L 743.84 876.50 L 755.92 876.78 L 768.00 877.06 L 768.00 883.53 L 768.00 890.00 L 744.00 890.00 C725.47,890.00 720.00,889.72 720.00,888.75 ZM 472.05 757.56 C470.50,755.69 471.65,753.47 473.41,754.93 C474.26,755.63 474.99,755.61 475.74,754.86 C477.08,753.52 479.00,754.58 479.00,756.67 C479.00,757.68 478.44,758.00 477.37,757.59 C476.48,757.25 475.19,757.43 474.51,758.00 C473.63,758.72 472.91,758.59 472.05,757.56 ZM 563.61 758.18 C560.91,753.81 558.82,745.16 559.20,739.91 C559.63,733.92 562.56,729.00 565.67,729.00 C566.48,729.00 567.00,727.82 567.00,726.00 C567.00,724.35 567.24,723.00 567.54,723.00 C567.96,723.00 571.95,725.30 573.89,726.67 C574.84,727.34 570.77,732.00 569.23,732.00 C568.28,732.01 566.06,732.88 564.30,733.96 C559.79,736.71 559.33,740.55 562.30,750.75 C564.54,758.45 564.85,760.18 563.61,758.18 ZM 491.65 753.25 C491.34,752.74 492.86,751.32 495.04,750.10 C497.39,748.78 499.00,747.13 499.00,746.05 C499.00,745.05 499.79,744.03 500.75,743.78 C501.71,743.52 503.85,740.72 505.50,737.55 C508.76,731.29 511.21,729.00 514.66,729.00 C516.50,729.00 516.93,729.64 517.19,732.75 L 517.50 736.50 L 520.21 732.00 C521.70,729.53 523.84,726.93 524.96,726.24 C527.54,724.65 527.56,721.98 525.00,718.73 C521.76,714.61 522.41,710.73 527.25,705.27 C529.59,702.63 532.73,698.91 534.24,696.99 C535.90,694.87 536.98,694.11 536.99,695.05 C537.00,697.20 531.92,704.89 528.13,708.44 C524.14,712.18 524.17,714.52 528.25,717.01 C536.38,721.97 543.87,716.64 539.50,709.00 C536.55,703.85 538.48,694.63 542.38,695.20 C545.52,695.66 547.73,700.75 548.26,708.75 C548.85,717.77 547.41,718.36 546.46,709.48 C545.80,703.30 543.24,698.00 540.93,698.00 C539.43,698.00 539.86,703.83 541.61,707.21 C545.49,714.71 540.43,723.72 532.90,722.71 C529.64,722.28 529.09,722.50 528.59,724.50 C528.27,725.76 526.54,728.56 524.74,730.71 C522.95,732.86 520.62,736.52 519.57,738.85 C517.46,743.52 516.04,742.88 516.02,737.22 C515.98,730.04 510.76,732.59 505.93,742.15 C502.98,747.99 498.96,752.00 496.07,752.00 C495.15,752.00 493.91,752.49 493.31,753.09 C492.67,753.73 491.99,753.79 491.65,753.25 ZM 469.00 750.00 C467.90,748.90 467.00,746.76 467.01,745.25 C467.01,741.17 468.83,735.39 470.54,733.97 C473.01,731.92 473.39,733.68 471.11,736.58 C468.36,740.08 468.29,745.55 470.98,746.99 C473.83,748.52 477.62,747.24 480.54,743.76 C483.51,740.23 483.34,738.98 479.63,737.17 C477.17,735.97 476.93,735.39 477.13,730.99 C477.25,728.32 476.82,725.48 476.16,724.69 C475.38,723.76 475.27,722.45 475.83,720.93 L 476.69 718.60 L 478.41 721.22 C479.66,723.12 479.96,724.94 479.51,727.92 C478.96,731.60 479.15,732.11 481.33,732.93 C483.04,733.58 483.90,734.84 484.25,737.18 C484.89,741.48 483.63,744.72 479.74,748.75 C476.08,752.55 472.02,753.02 469.00,750.00 ZM 492.59 740.15 C491.06,737.66 486.24,721.53 486.69,720.37 C487.73,717.66 488.63,719.13 490.48,726.56 C491.52,730.71 492.93,734.88 493.62,735.81 C495.56,738.41 498.48,736.10 498.59,731.88 C498.74,725.83 499.01,725.37 500.62,728.35 C502.29,731.42 501.87,734.94 499.41,738.75 C497.97,740.97 493.65,741.86 492.59,740.15 ZM 581.61 738.75 C579.30,735.12 575.69,720.91 576.80,719.80 C577.88,718.72 580.48,725.05 581.46,731.15 C582.52,737.70 586.36,738.68 589.74,733.25 C590.75,731.64 592.19,730.58 593.11,730.76 C594.13,730.97 595.19,729.96 596.01,727.97 C598.51,721.95 605.00,720.14 605.00,725.47 C605.00,728.48 605.72,728.58 608.80,726.02 L 611.10 724.10 L 609.05 722.05 C606.36,719.36 606.46,717.45 609.44,714.47 C611.36,712.55 612.38,712.21 614.19,712.87 C616.55,713.74 618.16,719.00 616.07,719.00 C615.48,719.00 615.00,718.58 615.00,718.07 C615.00,716.62 610.92,715.68 609.75,716.85 C607.82,718.78 613.60,720.59 617.25,719.21 C618.97,718.56 620.56,718.23 620.80,718.47 C621.82,719.48 607.04,732.16 602.06,734.55 C597.55,736.71 596.21,736.96 594.18,736.04 C592.84,735.43 591.66,735.05 591.57,735.21 C588.63,740.08 587.67,741.00 585.50,741.00 C584.05,741.00 582.46,740.08 581.61,738.75 ZM 602.04 729.96 C603.98,728.02 603.94,726.00 601.94,726.00 C600.69,726.00 597.00,729.73 597.00,731.00 C597.00,732.70 599.90,732.10 602.04,729.96 ZM 472.22 713.82 C471.36,712.96 471.34,712.29 472.15,711.32 C473.46,709.74 476.00,709.57 476.00,711.06 C476.00,711.64 475.55,711.84 475.00,711.50 C474.45,711.16 474.00,711.36 474.00,711.94 C474.00,713.35 475.32,713.28 476.80,711.80 C477.69,710.91 478.00,710.90 478.00,711.76 C478.00,712.41 477.13,713.40 476.07,713.96 C473.66,715.25 473.65,715.25 472.22,713.82 ZM 450.00 621.39 L 450.00 557.76 L 478.15 529.42 C501.82,505.58 506.57,501.24 508.08,502.04 C509.18,502.63 541.74,503.00 592.43,503.00 L 675.00 503.00 L 675.00 529.99 L 675.00 556.99 L 591.25 557.24 L 507.50 557.50 L 507.50 592.00 L 507.50 626.50 L 594.50 627.00 L 681.50 627.50 L 681.50 656.00 L 681.50 684.50 L 565.75 684.75 L 450.00 685.01 L 450.00 621.39 ZM 450.00 429.50 L 450.00 374.00 L 566.02 374.00 L 682.03 374.00 L 681.77 402.25 L 681.50 430.50 L 594.50 431.00 L 507.50 431.50 L 507.23 458.25 L 506.97 485.00 L 478.48 485.00 L 450.00 485.00 L 450.00 429.50 Z" fill="rgba(247,185,110,1)"/>
                </g>
            </svg>
        </a>
				<h1 id="pageTitleDisplay">Ù„Ù„ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± â¬†ï¸â¬†ï¸ ÙˆØ§ØªØ³Ø§Ø¨</h1>
    </div>
        <div class="login-box">
            <h2 style="color: var(--primary);">ØªÙˆØ§ØµÙ„ Ø¨Ø¯ÙˆÙ† â¬‡ï¸â¬‡ï¸ Ø¨Ø±Ù†Ø§Ù…Ø¬ ğŸ”’</h2>
            <p>Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ ÙˆØªØ­Ø¯Ø« Ù…Ø¨Ø§Ø´Ø±Ø©</p>
            
            <input type="text" id="my-name-input" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…..." onkeyup="checkSecretName(this)">
            <input type="password" id="password-field" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            
            <button class="btn btn-primary" onclick="handleLoginBtn()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <div id="chat-screen" class="screen">
        <div class="header">
            <div class="user-info">
                <div class="user-name" id="chat-header-name">Ø¹ØµØ§Ù…</div>
                <div class="user-status" id="connection-status">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...</div>
            </div>

            <div style="display: flex; align-items: center;">
                <div class="call-actions">
                    <button id="btn-audio" onclick="toggleCall('audio')">ğŸ“</button>
                    <button id="btn-video" onclick="toggleCall('video')">ğŸ“¹</button>
                </div>
                <button id="logout-btn" class="logout-btn" onclick="logoutAdmin()">Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>

        <div class="chat-body" id="chat-box"></div>
        <div class="chat-footer">
            <span class="attach-btn" onclick="document.getElementById('file-input').click()">ğŸ“</span>
            <input type="file" id="file-input" hidden onchange="sendFile(this)">
            <input type="text" id="msg-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." onkeypress="if(event.key==='Enter') sendText()">
            <button class="btn btn-primary" style="margin:0; width: auto; border-radius: 50%; padding: 12px 15px;" onclick="sendText()">â¤</button>
        </div>
    </div>

    <div id="incoming-modal">
        <div style="font-size:50px; margin-bottom:20px">ğŸ“²</div>
        <h3 id="incoming-caller-name">Ø´Ø®Øµ Ù…Ø§</h3>
        <p>ÙŠØªØµÙ„ Ø¨Ùƒ...</p>
        <div class="incoming-actions">
            <button class="action-btn" style="background: var(--red);" onclick="rejectCall()">âœ–</button>
            <button class="action-btn" style="background: var(--green);" onclick="acceptCall()">âœ”</button>
        </div>
    </div>
    <div id="video-modal">
        <video id="remote-video" autoplay playsinline></video>
        <video id="local-video" autoplay muted playsinline></video>
        <button class="action-btn" style="position:absolute; bottom:30px; left:50%; transform:translateX(-50%); background:var(--red);" onclick="endCurrentCall()">ğŸ“</button>
    </div>
    <div id="lightbox-modal">
        <div class="close-lightbox" onclick="closeLightbox()">âœ–</div>
        <div id="lightbox-content"></div>
    </div>

    <script>
        // ===========================================
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø­Ø³Ø§Ø³Ø©
        
        // 1. 
        const ADMIN_ID = "Essam-Host-Secure-ID-9988"; 
        
        // 2.
        const PASS_HASH = "61e54cf8a83c5f8b3d779b1766f82dd7e678dac5ab3a8ea856509757bbba5d3f"; 
        
        // 3. 
        const SECRET_NAMES = ["essho", "esshoo", "esshoa", "Essam"];
        // ===========================================

        let peer, conn, myName;
        let callObject = null, localStream = null, isCallActive = false, incomingReq = null;
        let audioCtx = null, ringOsc = null;

        // 4.
        window.onload = function() {
            const savedAdmin = localStorage.getItem('is_essam_admin_v2'); // 
            if (savedAdmin === 'true') {
                myName = "Ø¹ØµØ§Ù…";
                startApp(true); // 
            }
        };

        function checkSecretName(input) {
            const val = input.value.trim();
            const passField = document.getElementById('password-field');
            if (SECRET_NAMES.includes(val)) {
                passField.style.display = 'block';
                passField.focus();
            } else {
                passField.style.display = 'none';
            }
        }

function handleLoginBtn() {
    const nameInput = document.getElementById('my-name-input');
    const passInput = document.getElementById('password-field');
    myName = nameInput.value;
    
    if (!myName) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù…");

    // 
    if (passInput.style.display === 'block') {
        // 1. 
        const inputHash = CryptoJS.SHA256(passInput.value).toString();
        
        // 2. 
        if (inputHash === PASS_HASH) {
            localStorage.setItem('is_essam_admin_v2', 'true'); 
            startApp(true);
        } else {
            alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!");
        }
    } else {
        startApp(false);
    }
}

        function logoutAdmin() {
            if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ")) {
                localStorage.removeItem('is_essam_admin_v2');
                location.reload();
            }
        }

        function startApp(isHost) {
            initAudio();

            if (isHost) {
                // 
                document.getElementById('logout-btn').style.display = 'block';
                document.getElementById('chat-header-name').innerText = "Ù„ÙˆØ­Ø© Ø¹ØµØ§Ù…";
                
                // 
                peer = new Peer(ADMIN_ID);
                showScreen('chat-screen');
                document.getElementById('connection-status').innerText = "Ø¬Ø§Ø±ÙŠ Ø­Ø¬Ø² Ø§Ù„Ø®Ø·...";
                addSystemMessage("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¹ØµØ§Ù… (Ø§Ù„Ù…Ø¯ÙŠØ±).");

            } else {
                // 
                document.getElementById('logout-btn').style.display = 'none';
                peer = new Peer(); 
                showScreen('chat-screen');
                document.getElementById('connection-status').innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¹ØµØ§Ù…...";
                peer.on('open', () => { connectToAdmin(); });
            }

            setupPeerEvents(isHost);
        }

        function setupPeerEvents(isHost) {
            // 
            peer.on('error', (err) => {
                if (err.type === 'unavailable-id') {
                    // 
                    if (isHost) {
                        alert("âš ï¸ ØªÙ†Ø¨ÙŠÙ‡ Ø£Ù…Ù†ÙŠ:\nØ¹ØµØ§Ù… Ù…ØªØµÙ„ Ø¨Ø§Ù„ÙØ¹Ù„ Ù…Ù† Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø±!\nÙ„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ù† Ø¬Ù‡Ø§Ø²ÙŠÙ† ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª.");
                        // 
                        localStorage.removeItem('is_essam_admin_v2');
                        location.reload();
                    }
                } else if (err.type === 'peer-unavailable') {
                    document.getElementById('connection-status').innerText = "Ø¹ØµØ§Ù… ØºÙŠØ± Ù…ØªØµÙ„ âŒ";
                    addSystemMessage("Ø¹ØµØ§Ù… ØºÙŠØ± Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹.");
                } else {
                    console.log(err);
                }
            });

            peer.on('open', (id) => {
                if(isHost) {
                    document.getElementById('connection-status').innerText = "Ø£Ù†Øª Ù…ØªØµÙ„ (Ø§Ù„Ù…Ø¯ÙŠØ±) âœ…";
                    //
                }
            });

            peer.on('connection', (c) => { conn = c; setupConnection(isHost); });
            peer.on('call', (call) => { handleIncomingCall(call); });
        }

        // 
        function connectToAdmin() { conn = peer.connect(ADMIN_ID, { metadata: { name: myName } }); setupConnection(false); }
        function setupConnection(isHost) { conn.on('open', () => { document.getElementById('connection-status').innerText = "Ù…ØªØµÙ„ âœ…"; if(conn.metadata && conn.metadata.name) { updateHeaderName(conn.metadata.name); notifyUser('msg'); addSystemMessage(isHost ? `Ø¯Ø®Ù„ ${conn.metadata.name} Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©` : "ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¹ØµØ§Ù…"); } else { conn.send({ type: 'name-handshake', name: myName }); } }); conn.on('data', (data) => { if(typeof data === 'string') { addMessage(data, 'other'); notifyUser('msg'); } else if (data.type === 'name-handshake') { updateHeaderName(data.name); notifyUser('msg'); addSystemMessage(`Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø±: ${data.name}`); } else if (data.type === 'file') { const blob = new Blob([new Uint8Array(data.file)], { type: data.fileType }); renderFileMessage({ file: blob, fileType: data.fileType, fileName: data.fileName }, 'other'); notifyUser('msg'); } else if (data.type === 'call-end') { endCurrentCall(false); } }); conn.on('close', () => { document.getElementById('connection-status').innerText = "Ø§Ù†Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ âŒ"; addSystemMessage("ØºØ§Ø¯Ø± Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø±."); }); }
        function updateHeaderName(name) { document.getElementById('chat-header-name').innerText = name; }
        function showScreen(id) { document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen')); document.getElementById(id).classList.add('active-screen'); }
        function sendText() { const txt = document.getElementById('msg-input').value; if(!txt || !conn) return; conn.send(txt); addMessage(txt, 'me'); document.getElementById('msg-input').value = ''; }
        function addMessage(content, source) { const box = document.getElementById('chat-box'); const div = document.createElement('div'); div.className = `message ${source === 'me' ? 'msg-me' : 'msg-other'}`; div.innerText = content; box.appendChild(div); box.scrollTop = box.scrollHeight; }
        function addSystemMessage(txt) { const box = document.getElementById('chat-box'); const div = document.createElement('div'); div.className = 'sys-msg'; div.innerText = txt; box.appendChild(div); box.scrollTop = box.scrollHeight; }
        function sendFile(input) { const file = input.files[0]; if (!file || !conn) return; const reader = new FileReader(); reader.onload = (e) => { const buffer = e.target.result; conn.send({ type: 'file', file: buffer, fileName: file.name, fileType: file.type }); const blob = new Blob([buffer], { type: file.type }); renderFileMessage({ file: blob, fileType: file.type, fileName: file.name }, 'me'); }; reader.readAsArrayBuffer(file); input.value = ''; }
        function renderFileMessage(data, source) { const box = document.getElementById('chat-box'); const div = document.createElement('div'); div.className = `message ${source === 'me' ? 'msg-me' : 'msg-other'}`; const url = URL.createObjectURL(data.file); if (data.fileType.startsWith('image/')) { div.innerHTML = `<img src="${url}" class="media-thumb" onclick="openLightbox('${url}', 'img')">`; } else if (data.fileType.startsWith('video/')) { div.innerHTML = `<video src="${url}" class="media-thumb" onclick="openLightbox('${url}', 'video')"></video>`; } else { div.innerHTML = `<a href="${url}" download="${data.fileName}" class="file-link">ğŸ“ ${data.fileName}</a>`; } box.appendChild(div); box.scrollTop = box.scrollHeight; }
        function openLightbox(url, type) { const modal = document.getElementById('lightbox-modal'); const content = document.getElementById('lightbox-content'); modal.style.display = 'flex'; if(type === 'img') content.innerHTML = `<img src="${url}" id="lightbox-img">`; else content.innerHTML = `<video src="${url}" controls autoplay id="lightbox-video"></video>`; }
        function closeLightbox() { document.getElementById('lightbox-modal').style.display = 'none'; document.getElementById('lightbox-content').innerHTML = ''; }
        function toggleCall(type) { if (isCallActive) { if (confirm("Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©ØŸ")) endCurrentCall(true); } else startCall(type); }
        function startCall(type) { if(!conn) return alert("Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø±"); navigator.mediaDevices.getUserMedia({video: (type==='video'), audio: true}).then(stream => { localStream = stream; if(type === 'video') { document.getElementById('video-modal').style.display = 'block'; document.getElementById('local-video').srcObject = stream; } const call = peer.call(conn.peer, stream, { metadata: { type: type, name: myName } }); handleCallStream(call); setCallActiveState(true, type); }); }
        function handleIncomingCall(call) { incomingReq = call; document.getElementById('incoming-modal').style.display = 'flex'; document.getElementById('incoming-caller-name').innerText = (call.metadata && call.metadata.name) ? call.metadata.name : "Ù…Ø¬Ù‡ÙˆÙ„"; notifyUser('ring'); }
        function acceptCall() { stopNotification(); document.getElementById('incoming-modal').style.display = 'none'; const isVideo = incomingReq.metadata.type === 'video'; navigator.mediaDevices.getUserMedia({video: isVideo, audio: true}).then(stream => { localStream = stream; incomingReq.answer(stream); if(isVideo) { document.getElementById('video-modal').style.display = 'block'; document.getElementById('local-video').srcObject = stream; } handleCallStream(incomingReq); setCallActiveState(true, incomingReq.metadata.type); }); }
        function rejectCall() { stopNotification(); document.getElementById('incoming-modal').style.display = 'none'; if(incomingReq) incomingReq.close(); if(conn) conn.send({type: 'call-end'}); }
        function handleCallStream(call) { callObject = call; call.on('stream', remoteStream => { if(document.getElementById('video-modal').style.display === 'block') { document.getElementById('remote-video').srcObject = remoteStream; } else { const audio = new Audio(); audio.srcObject = remoteStream; audio.play(); } }); call.on('close', () => endCurrentCall(false)); }
        function endCurrentCall(notify = true) { if(callObject) callObject.close(); if(localStream) localStream.getTracks().forEach(t => t.stop()); document.getElementById('video-modal').style.display = 'none'; setCallActiveState(false); if(notify && conn) conn.send({type: 'call-end'}); }
        function setCallActiveState(active, type) { isCallActive = active; const btnAudio = document.getElementById('btn-audio'); const btnVideo = document.getElementById('btn-video'); btnAudio.classList.remove('btn-active-call'); btnVideo.classList.remove('btn-active-call'); if(active) { if(type === 'audio') btnAudio.classList.add('btn-active-call'); if(type === 'video') btnVideo.classList.add('btn-active-call'); } }
        function initAudio() { if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); if(audioCtx.state === 'suspended') audioCtx.resume(); }
        function notifyUser(type) { if(!audioCtx) return; const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain(); osc.connect(gain); gain.connect(audioCtx.destination); if (type === 'msg') { osc.type = 'sine'; osc.frequency.setValueAtTime(600, audioCtx.currentTime); gain.gain.setValueAtTime(0.1, audioCtx.currentTime); gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.5); osc.start(); osc.stop(audioCtx.currentTime + 0.5); if(navigator.vibrate) navigator.vibrate(200); } else if (type === 'ring') { osc.type = 'triangle'; osc.frequency.setValueAtTime(400, audioCtx.currentTime); gain.gain.setValueAtTime(0.5, audioCtx.currentTime); osc.start(); ringOsc = { osc: osc, gain: gain }; if(window.ringInterval) clearInterval(window.ringInterval); window.ringInterval = setInterval(() => { if(audioCtx.state === 'running') { const o = audioCtx.createOscillator(); const g = audioCtx.createGain(); o.connect(g); g.connect(audioCtx.destination); o.frequency.setValueAtTime(440, audioCtx.currentTime); g.gain.setValueAtTime(0.3, audioCtx.currentTime); g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.5); o.start(); o.stop(audioCtx.currentTime + 0.5); } }, 1500); if(navigator.vibrate) navigator.vibrate([500, 200, 500]); } }
        function stopNotification() { if(window.ringInterval) clearInterval(window.ringInterval); if(ringOsc) { try{ ringOsc.osc.stop(); }catch(e){} ringOsc=null; } if(navigator.vibrate) navigator.vibrate(0); }
    </script>
	<script>
    document.addEventListener("DOMContentLoaded", function() {
        // === Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ­ÙƒÙ… ===
        // ØºÙŠØ± Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… Ù„ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©
        // 1 = Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
        // 1.5 = ØªÙƒØ¨ÙŠØ± Ù…Ø±Ø© ÙˆÙ†ØµÙ
        // 2 = ØªÙƒØ¨ÙŠØ± Ù…Ø±ØªÙŠÙ† (Ø¶Ø¹Ù Ø§Ù„Ø­Ø¬Ù…)
        // Ø¬Ø±Ø¨ 2 Ø£Ùˆ 2.5 Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹
        const zoomFactor = 2.5; 
        // =====================

        const svgElement = document.querySelector('.Essam svg');
        const faviconLink = document.getElementById('dynamic-favicon');

        if (svgElement && faviconLink) {
            // 1. Ø£Ø®Ø° Ù†Ø³Ø®Ø© Ù…Ù† Ø§Ù„Ù€ SVG
            const clonedSvg = svgElement.cloneNode(true);
            
            // 2. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù€ ViewBox Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø© Ù†Ø¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„Ø§Ø±ØªÙØ§Ø¹
            let viewBox = clonedSvg.getAttribute('viewBox').split(' ').map(Number);
            let [x, y, w, h] = viewBox;

            // 3. Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø¹Ù…Ù„ "Ø²ÙˆÙˆÙ…" ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ
            const newWidth = w / zoomFactor;
            const newHeight = h / zoomFactor;
            const newX = x + (w - newWidth) / 2;
            const newY = y + (h - newHeight) / 2;

            // 4. ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ø§Ù„Ù‚Øµ)
            clonedSvg.setAttribute('viewBox', `${newX} ${newY} ${newWidth} ${newHeight}`);

            // 5. (Ø®Ø·ÙˆØ© Ø¥Ø¶Ø§ÙÙŠØ©) ØªØ³Ù…ÙŠÙƒ Ø§Ù„Ø®Ø·ÙˆØ· ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ù„ØªÙƒÙˆÙ† ÙˆØ§Ø¶Ø­Ø©
            // Ù†Ù‚ÙˆÙ… Ø¨Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ÙƒÙ„ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙˆÙ†Ø²ÙŠØ¯ Ø³Ù…Ùƒ Ø§Ù„Ø­Ø¯ÙˆØ¯
            const elements = clonedSvg.querySelectorAll('path, circle, line, rect, polyline');
            elements.forEach(el => {
                let currentWidth = parseFloat(getComputedStyle(el).strokeWidth) || 1;
                el.style.strokeWidth = `${currentWidth * 1}px`; // Ø²ÙŠØ§Ø¯Ø© Ø³Ù…Ùƒ Ø§Ù„Ø®Ø·
            });

            // 6. Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙˆÙˆØ¶Ø¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©
            const serializer = new XMLSerializer();
            const svgString = serializer.serializeToString(clonedSvg);
            const encodedSvg = encodeURIComponent(svgString);
            faviconLink.href = `data:image/svg+xml;charset=utf-8,${encodedSvg}`;
        }
    });
</script>
</body>
</html>

